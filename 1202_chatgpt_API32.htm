Version:0.9
StartHTML:0000000105
EndHTML:0000045982
StartFragment:0000001053
EndFragment:0000045966
<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>mXScriptasHTML</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<meta name="generator" content="SynEdit HTML exporter" />
<style type="text/css">
<!--
body { color: #000000; background-color: #FFFFFF; }
.pas1-assembler { }
.pas1-character { color: #0066CC; text-decoration: underline; }
.pas1-comment { color: #000080; font-style: italic; }
.pas1-float { color: #00FF00; }
.pas1-hexadecimal { color: #FF00FF; }
.pas1-identifier { }
.pas1-number { color: #FF0000; }
.pas1-preprocessor { font-style: italic; }
.pas1-reservedword { color: #000080; font-weight: bold; }
.pas1-space { }
.pas1-string { color: #008080; }
.pas1-symbol { color: #FF0000; }
-->
</style>
</head>
<body>
<!--StartFragment--><pre><code><span class="pas1-reservedword">program</span><span class="pas1-space"> ChatGPT_API31_mX4</span><span class="pas1-symbol">;

</span><span class="pas1-comment">//https://rosettacode.org/wiki/100_prisoners#Pascal
//https://github.com/ssut/py-googletrans/issues/268

</span><span class="pas1-reservedword">const
</span><span class="pas1-space">   
  AURLS</span><span class="pas1-symbol">=</span><span class="pas1-string">'https://clients5.google.com/translate_a/t?client=dict-chrome-ex&amp;sl=%s&amp;tl=%s&amp;q=%s'</span><span class="pas1-symbol">;
</span><span class="pas1-space">  AURL</span><span class="pas1-symbol">=</span><span class="pas1-string">'https://translate.googleapis.com/translate_a/single'</span><span class="pas1-symbol">;
</span><span class="pas1-space">  UAGENT </span><span class="pas1-symbol">=</span><span class="pas1-string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/111.0'</span><span class="pas1-symbol">;
</span><span class="pas1-space">  
  TESTRES_JSON </span><span class="pas1-symbol">=</span><span class="pas1-space"> </span><span class="pas1-string">'{&quot;id&quot;:&quot;cmpl-6zpQsiothxZUox0WCKWNdJKj6VDa7&quot;,&quot;object&quot;:&quot;text_completion&quot;,&quot;created&quot;:1680193734,&quot;model&quot;:&quot;text-davinci-003&quot;,&quot;choices&quot;:[{&quot;text&quot;:&quot;\n\nmaXbox4 is a free and open source scripting language and development environment for Windows. It is designed to be easy to use and provides a powerful scripting language for creating applications, games, and other software. maXbox4 is based on the popular PASCAL language and includes a wide range of features, including support for object-oriented programming, graphical user interfaces, and more.&quot;,&quot;index&quot;:0,&quot;logprobs&quot;:null,&quot;finish_reason&quot;:&quot;stop&quot;}],&quot;usage&quot;:{&quot;prompt_tokens&quot;:6,&quot;completion_tokens&quot;:77,&quot;total_tokens&quot;:83}} '</span><span class="pas1-symbol">;


</span><span class="pas1-reservedword">function</span><span class="pas1-space"> Text_to_translate_API2</span><span class="pas1-symbol">(</span><span class="pas1-identifier">AURL</span><span class="pas1-symbol">,</span><span class="pas1-space"> aclient</span><span class="pas1-symbol">,</span><span class="pas1-identifier">langorig</span><span class="pas1-symbol">,</span><span class="pas1-identifier">langtarget</span><span class="pas1-symbol">,</span><span class="pas1-identifier">atext</span><span class="pas1-symbol">:</span><span class="pas1-space"> </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">):</span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;</span><span class="pas1-space"> </span><span class="pas1-reservedword">forward</span><span class="pas1-symbol">;

</span><span class="pas1-reservedword">function</span><span class="pas1-space"> Text_to_translate_API2</span><span class="pas1-symbol">(</span><span class="pas1-identifier">AURL</span><span class="pas1-symbol">,</span><span class="pas1-space"> aclient</span><span class="pas1-symbol">,</span><span class="pas1-identifier">langorig</span><span class="pas1-symbol">,</span><span class="pas1-identifier">langtarget</span><span class="pas1-symbol">,</span><span class="pas1-identifier">atext</span><span class="pas1-symbol">:</span><span class="pas1-space"> </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">):</span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">var</span><span class="pas1-space"> httpq</span><span class="pas1-symbol">:</span><span class="pas1-space"> THttpConnectionWinInet</span><span class="pas1-symbol">;
</span><span class="pas1-space">    rets</span><span class="pas1-symbol">:</span><span class="pas1-space"> TStringStream</span><span class="pas1-symbol">;</span><span class="pas1-space">  
    heads</span><span class="pas1-symbol">:</span><span class="pas1-space"> TStrings</span><span class="pas1-symbol">;</span><span class="pas1-space"> iht</span><span class="pas1-symbol">:</span><span class="pas1-identifier">IHttpConnection2</span><span class="pas1-symbol">;</span><span class="pas1-space"> 
    jo</span><span class="pas1-symbol">:</span><span class="pas1-space"> TJSON</span><span class="pas1-symbol">;</span><span class="pas1-space"> jarr</span><span class="pas1-symbol">:</span><span class="pas1-identifier">TJsonArray2</span><span class="pas1-symbol">;</span><span class="pas1-space"> jobj</span><span class="pas1-symbol">:</span><span class="pas1-space"> TJsonObject2</span><span class="pas1-symbol">;
</span><span class="pas1-space">    tmpstr</span><span class="pas1-symbol">:</span><span class="pas1-space"> </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;</span><span class="pas1-space"> 
</span><span class="pas1-reservedword">begin
</span><span class="pas1-space">  httpq</span><span class="pas1-symbol">:=</span><span class="pas1-space"> THttpConnectionWinInet</span><span class="pas1-symbol">.</span><span class="pas1-identifier">Create</span><span class="pas1-symbol">(</span><span class="pas1-identifier">true</span><span class="pas1-symbol">);</span><span class="pas1-space"> 
  rets</span><span class="pas1-symbol">:=</span><span class="pas1-space"> TStringStream</span><span class="pas1-symbol">.</span><span class="pas1-identifier">create</span><span class="pas1-symbol">(</span><span class="pas1-string">''</span><span class="pas1-symbol">);
</span><span class="pas1-space">  heads</span><span class="pas1-symbol">:=</span><span class="pas1-space"> TStringlist</span><span class="pas1-symbol">.</span><span class="pas1-identifier">create</span><span class="pas1-symbol">;</span><span class="pas1-space">     
   </span><span class="pas1-reservedword">try
</span><span class="pas1-space">     </span><span class="pas1-comment">{heads.add('client='+aclient);
     heads.add('sl=auto');
     heads.add('tl='+ langTarget);
     heads.add('t='+atext); }
</span><span class="pas1-space">     heads</span><span class="pas1-symbol">.</span><span class="pas1-identifier">add</span><span class="pas1-symbol">(</span><span class="pas1-string">'User-Agent='</span><span class="pas1-symbol">+</span><span class="pas1-identifier">UAGENT</span><span class="pas1-symbol">);
</span><span class="pas1-space">     iht</span><span class="pas1-symbol">:=</span><span class="pas1-space"> httpq</span><span class="pas1-symbol">.</span><span class="pas1-identifier">setHeaders</span><span class="pas1-symbol">(</span><span class="pas1-identifier">heads</span><span class="pas1-symbol">);
</span><span class="pas1-space">     </span><span class="pas1-comment">//iht:= httpq.setParameters(heads);
</span><span class="pas1-space">     httpq</span><span class="pas1-symbol">.</span><span class="pas1-identifier">Get</span><span class="pas1-symbol">(</span><span class="pas1-identifier">Format</span><span class="pas1-symbol">(</span><span class="pas1-identifier">AURLS</span><span class="pas1-symbol">,[</span><span class="pas1-identifier">langorig</span><span class="pas1-symbol">,</span><span class="pas1-identifier">langtarget</span><span class="pas1-symbol">,</span><span class="pas1-identifier">atext</span><span class="pas1-symbol">]),</span><span class="pas1-identifier">rets</span><span class="pas1-symbol">);
</span><span class="pas1-space">     writeln</span><span class="pas1-symbol">(</span><span class="pas1-string">'server: '</span><span class="pas1-symbol">+</span><span class="pas1-identifier">Httpq</span><span class="pas1-symbol">.</span><span class="pas1-identifier">GetResponseHeader</span><span class="pas1-symbol">(</span><span class="pas1-string">'server'</span><span class="pas1-symbol">));
</span><span class="pas1-space">     </span><span class="pas1-comment">//writeln(Httpq.GetResponseHeader('pragma'));  
</span><span class="pas1-space">     </span><span class="pas1-comment">//tmpstr:= StringReplace(rets.datastring, '[','{[',[rfReplaceAll, rfIgnoreCase]);  
</span><span class="pas1-space">     </span><span class="pas1-comment">//tmpstr:= StringReplace(tmpstr, ']',']}',[rfReplaceAll, rfIgnoreCase]);     
</span><span class="pas1-space">      jo</span><span class="pas1-symbol">:=</span><span class="pas1-space"> TJSON</span><span class="pas1-symbol">.</span><span class="pas1-identifier">Create</span><span class="pas1-symbol">();</span><span class="pas1-space"> 
      jo</span><span class="pas1-symbol">.</span><span class="pas1-identifier">parse</span><span class="pas1-symbol">(</span><span class="pas1-identifier">rets</span><span class="pas1-symbol">.</span><span class="pas1-identifier">datastring</span><span class="pas1-symbol">)</span><span class="pas1-space">   
      jarr</span><span class="pas1-symbol">:=</span><span class="pas1-space"> jo</span><span class="pas1-symbol">.</span><span class="pas1-identifier">JsonArray</span><span class="pas1-symbol">;
</span><span class="pas1-space">      </span><span class="pas1-comment">//writeln(jarr.items[0].stringify);
</span><span class="pas1-space">      </span><span class="pas1-reservedword">if</span><span class="pas1-space"> httpq</span><span class="pas1-symbol">.</span><span class="pas1-identifier">getresponsecode</span><span class="pas1-symbol">=200</span><span class="pas1-space"> </span><span class="pas1-reservedword">Then</span><span class="pas1-space"> result</span><span class="pas1-symbol">:=</span><span class="pas1-identifier">jarr</span><span class="pas1-symbol">[0].</span><span class="pas1-identifier">stringify
       </span><span class="pas1-reservedword">else</span><span class="pas1-space"> result</span><span class="pas1-symbol">:=</span><span class="pas1-string">'Failed:'</span><span class="pas1-symbol">+
</span><span class="pas1-space">             itoa</span><span class="pas1-symbol">(</span><span class="pas1-identifier">Httpq</span><span class="pas1-symbol">.</span><span class="pas1-identifier">getresponsecode</span><span class="pas1-symbol">)+</span><span class="pas1-identifier">Httpq</span><span class="pas1-symbol">.</span><span class="pas1-identifier">GetResponseHeader</span><span class="pas1-symbol">(</span><span class="pas1-string">'message'</span><span class="pas1-symbol">);</span><span class="pas1-space">    
   </span><span class="pas1-reservedword">except</span><span class="pas1-space"> 
      writeln</span><span class="pas1-symbol">(</span><span class="pas1-string">'EWI_HTTP: '</span><span class="pas1-symbol">+</span><span class="pas1-identifier">ExceptiontoString</span><span class="pas1-symbol">(</span><span class="pas1-identifier">exceptiontype</span><span class="pas1-symbol">,</span><span class="pas1-identifier">exceptionparam</span><span class="pas1-symbol">));
</span><span class="pas1-space">   </span><span class="pas1-reservedword">finally
</span><span class="pas1-space">     </span><span class="pas1-comment">//httpq.free;
</span><span class="pas1-space">     httpq</span><span class="pas1-symbol">:=</span><span class="pas1-space"> </span><span class="pas1-reservedword">Nil</span><span class="pas1-symbol">;
</span><span class="pas1-space">     heads</span><span class="pas1-symbol">.</span><span class="pas1-identifier">Free</span><span class="pas1-symbol">;
</span><span class="pas1-space">     rets</span><span class="pas1-symbol">.</span><span class="pas1-identifier">Free</span><span class="pas1-symbol">;
</span><span class="pas1-space">     jo</span><span class="pas1-symbol">.</span><span class="pas1-identifier">free</span><span class="pas1-symbol">;
</span><span class="pas1-space">   </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;</span><span class="pas1-space">                  
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;


</span><span class="pas1-reservedword">Const</span><span class="pas1-space"> CHATGPT_APIKEY1 </span><span class="pas1-symbol">=</span><span class="pas1-space"> </span><span class="pas1-string">'sk-Lx_________use your own key___________________'</span><span class="pas1-symbol">;

</span><span class="pas1-preprocessor">{$I .\OPENAIAPIKEY.INC}

</span><span class="pas1-reservedword">function</span><span class="pas1-space"> AskChatGPT</span><span class="pas1-symbol">(</span><span class="pas1-identifier">askstream</span><span class="pas1-symbol">:</span><span class="pas1-space"> </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">):</span><span class="pas1-space"> </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">var
</span><span class="pas1-space">  httpReq</span><span class="pas1-symbol">,</span><span class="pas1-identifier">hr</span><span class="pas1-symbol">:</span><span class="pas1-space"> Olevariant</span><span class="pas1-symbol">;
</span><span class="pas1-space">  JPostdata</span><span class="pas1-symbol">:</span><span class="pas1-space"> </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-space">  LJsonValue</span><span class="pas1-symbol">:</span><span class="pas1-space"> TJsonValue</span><span class="pas1-symbol">;
</span><span class="pas1-space">  LJsonArray</span><span class="pas1-symbol">:</span><span class="pas1-space"> TJsonArray</span><span class="pas1-symbol">;
</span><span class="pas1-space">  jo</span><span class="pas1-symbol">:</span><span class="pas1-space"> TJSON</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">begin
</span><span class="pas1-space">  Result</span><span class="pas1-symbol">:=</span><span class="pas1-space"> </span><span class="pas1-string">''</span><span class="pas1-symbol">;
</span><span class="pas1-space">  JPostData</span><span class="pas1-symbol">:=</span><span class="pas1-space"> </span><span class="pas1-string">'{'</span><span class="pas1-space"> </span><span class="pas1-symbol">+
</span><span class="pas1-space">    </span><span class="pas1-string">'&quot;model&quot;: &quot;text-davinci-003&quot;,'</span><span class="pas1-symbol">+
</span><span class="pas1-space">    </span><span class="pas1-comment">//'&quot;prompt&quot;: &quot;' + AQuestion + '&quot;,'+
</span><span class="pas1-space">    </span><span class="pas1-string">'&quot;prompt&quot;: &quot;%s&quot;,'</span><span class="pas1-symbol">+
</span><span class="pas1-space">    </span><span class="pas1-string">'&quot;max_tokens&quot;: 2048,'</span><span class="pas1-symbol">+
</span><span class="pas1-space">    </span><span class="pas1-string">'&quot;temperature&quot;: 0.1'</span><span class="pas1-symbol">+
</span><span class="pas1-space">    </span><span class="pas1-string">'}'</span><span class="pas1-symbol">;

</span><span class="pas1-space">  </span><span class="pas1-comment">// Use JSON for the REST API calls and set API KEY via Authorization header
</span><span class="pas1-space">  httpReq</span><span class="pas1-symbol">:=</span><span class="pas1-space"> CreateOleObject</span><span class="pas1-symbol">(</span><span class="pas1-string">'WinHttp.WinHttpRequest.5.1'</span><span class="pas1-symbol">);
</span><span class="pas1-space">  jo</span><span class="pas1-symbol">:=</span><span class="pas1-space"> TJSON</span><span class="pas1-symbol">.</span><span class="pas1-identifier">Create</span><span class="pas1-symbol">();
</span><span class="pas1-space">  </span><span class="pas1-reservedword">try</span><span class="pas1-space">             
    hr</span><span class="pas1-symbol">:=</span><span class="pas1-space"> httpReq</span><span class="pas1-symbol">.</span><span class="pas1-identifier">Open</span><span class="pas1-symbol">(</span><span class="pas1-string">'POST'</span><span class="pas1-symbol">,
</span><span class="pas1-space">               </span><span class="pas1-string">'https://api.openai.com/v1/completions'</span><span class="pas1-symbol">,</span><span class="pas1-space"> false</span><span class="pas1-symbol">);
</span><span class="pas1-space">    </span><span class="pas1-comment">//httpReq.setRequestheader('user-agent',UAGENT);
</span><span class="pas1-space">    </span><span class="pas1-comment">// Select HTTPS POST method, set POST data and specify endpoint URL
</span><span class="pas1-space">    httpReq</span><span class="pas1-symbol">.</span><span class="pas1-identifier">setRequestheader</span><span class="pas1-symbol">(</span><span class="pas1-string">'content-type'</span><span class="pas1-symbol">,</span><span class="pas1-string">'application/json'</span><span class="pas1-symbol">);</span><span class="pas1-space"> 
    httpReq</span><span class="pas1-symbol">.</span><span class="pas1-identifier">setRequestheader</span><span class="pas1-symbol">(</span><span class="pas1-string">'Authorization'</span><span class="pas1-symbol">,</span><span class="pas1-string">'Bearer '</span><span class="pas1-symbol">+</span><span class="pas1-space"> CHATGPT_APIKEY2</span><span class="pas1-symbol">);
</span><span class="pas1-space">    </span><span class="pas1-reservedword">if</span><span class="pas1-space"> hr</span><span class="pas1-symbol">=</span><span class="pas1-space"> S_OK </span><span class="pas1-reservedword">then</span><span class="pas1-space"> HttpReq</span><span class="pas1-symbol">.</span><span class="pas1-identifier">Send</span><span class="pas1-symbol">(</span><span class="pas1-identifier">format</span><span class="pas1-symbol">(</span><span class="pas1-identifier">JPostData</span><span class="pas1-symbol">,[</span><span class="pas1-identifier">askstream</span><span class="pas1-symbol">]));
</span><span class="pas1-space">    </span><span class="pas1-comment">//writeln(format(JTESTDATA,[feedstream]));
</span><span class="pas1-space">    </span><span class="pas1-reservedword">If</span><span class="pas1-space"> HttpReq</span><span class="pas1-symbol">.</span><span class="pas1-identifier">Status </span><span class="pas1-symbol">=</span><span class="pas1-space"> </span><span class="pas1-number">200</span><span class="pas1-space"> </span><span class="pas1-reservedword">Then
</span><span class="pas1-space">       result</span><span class="pas1-symbol">:=</span><span class="pas1-space"> HttpReq</span><span class="pas1-symbol">.</span><span class="pas1-identifier">responseText
    </span><span class="pas1-reservedword">Else</span><span class="pas1-space"> result</span><span class="pas1-symbol">:=</span><span class="pas1-space"> </span><span class="pas1-string">'Failed at getting response:'</span><span class="pas1-symbol">+</span><span class="pas1-identifier">itoa</span><span class="pas1-symbol">(</span><span class="pas1-identifier">HttpReq</span><span class="pas1-symbol">.</span><span class="pas1-identifier">Status</span><span class="pas1-symbol">)+</span><span class="pas1-identifier">HttpReq</span><span class="pas1-symbol">.</span><span class="pas1-identifier">responseText</span><span class="pas1-symbol">;
</span><span class="pas1-space">    </span><span class="pas1-comment">//writeln('debug response '+HttpReq.GetAllResponseHeaders); 
</span><span class="pas1-space">    </span><span class="pas1-comment">// Process returned JSON when request was successful 
</span><span class="pas1-space">    jo</span><span class="pas1-symbol">.</span><span class="pas1-identifier">parse</span><span class="pas1-symbol">(</span><span class="pas1-identifier">result</span><span class="pas1-symbol">)</span><span class="pas1-space"> 
    result</span><span class="pas1-symbol">:=</span><span class="pas1-string">'Answer2: '</span><span class="pas1-symbol">+</span><span class="pas1-identifier">jo</span><span class="pas1-symbol">.</span><span class="pas1-identifier">values</span><span class="pas1-symbol">[</span><span class="pas1-string">'choices'</span><span class="pas1-symbol">].</span><span class="pas1-identifier">asarray</span><span class="pas1-symbol">[0].</span><span class="pas1-identifier">asobject</span><span class="pas1-symbol">[</span><span class="pas1-string">'text'</span><span class="pas1-symbol">].</span><span class="pas1-identifier">asstring</span><span class="pas1-symbol">;
</span><span class="pas1-space">  </span><span class="pas1-reservedword">finally
</span><span class="pas1-space">    jo</span><span class="pas1-symbol">.</span><span class="pas1-identifier">Free</span><span class="pas1-symbol">;
</span><span class="pas1-space">    httpreq</span><span class="pas1-symbol">:=</span><span class="pas1-space"> unassigned</span><span class="pas1-symbol">;</span><span class="pas1-space">  
  </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;</span><span class="pas1-space">                
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;


</span><span class="pas1-reservedword">function</span><span class="pas1-space"> TALHTTPClient_AskChatGPT</span><span class="pas1-symbol">(</span><span class="pas1-identifier">feedstream</span><span class="pas1-symbol">,</span><span class="pas1-space"> apiKey</span><span class="pas1-symbol">:</span><span class="pas1-space"> </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-space">                       aResponseContentStream</span><span class="pas1-symbol">:</span><span class="pas1-identifier">TStream</span><span class="pas1-symbol">;
</span><span class="pas1-space">                       aResponseContentHeader</span><span class="pas1-symbol">:</span><span class="pas1-identifier">TALHTTPResponseHeader</span><span class="pas1-symbol">):</span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">Var
</span><span class="pas1-space">   FRequestHeader</span><span class="pas1-symbol">:</span><span class="pas1-space"> TALHTTPRequestHeader</span><span class="pas1-symbol">;
</span><span class="pas1-space">   aPoststream</span><span class="pas1-symbol">:</span><span class="pas1-space"> TStream</span><span class="pas1-symbol">;
</span><span class="pas1-space">   JPostdata</span><span class="pas1-symbol">:</span><span class="pas1-space"> </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">begin
</span><span class="pas1-space">  JPostData</span><span class="pas1-symbol">:=</span><span class="pas1-space"> </span><span class="pas1-string">'{'</span><span class="pas1-space"> </span><span class="pas1-symbol">+
</span><span class="pas1-space">    </span><span class="pas1-string">'&quot;model&quot;: &quot;text-davinci-003&quot;,'</span><span class="pas1-symbol">+
</span><span class="pas1-space">    </span><span class="pas1-comment">//'&quot;prompt&quot;: &quot;' + AQuestion + '&quot;,'+
</span><span class="pas1-space">    </span><span class="pas1-string">'&quot;prompt&quot;: &quot;%s&quot;,'</span><span class="pas1-symbol">+
</span><span class="pas1-space">    </span><span class="pas1-string">'&quot;max_tokens&quot;: 2048,'</span><span class="pas1-symbol">+
</span><span class="pas1-space">    </span><span class="pas1-string">'&quot;temperature&quot;: 0.1'</span><span class="pas1-symbol">+
</span><span class="pas1-space">    </span><span class="pas1-string">'}'</span><span class="pas1-symbol">;
</span><span class="pas1-space">    
  </span><span class="pas1-reservedword">with</span><span class="pas1-space"> TALWininetHttpClient</span><span class="pas1-symbol">.</span><span class="pas1-identifier">create </span><span class="pas1-reservedword">do</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-space">    Url</span><span class="pas1-symbol">:=</span><span class="pas1-space"> </span><span class="pas1-string">'https://api.openai.com/v1/completions'</span><span class="pas1-symbol">;
</span><span class="pas1-space">    RequestMethod</span><span class="pas1-symbol">:=</span><span class="pas1-space"> HTTPmt_Post</span><span class="pas1-symbol">;</span><span class="pas1-space"> </span><span class="pas1-comment">//HTTPrm_Post;
</span><span class="pas1-space">    </span><span class="pas1-comment">//RequestHeader.UserAgent:= UAGENT;
</span><span class="pas1-space">    RequestHeader</span><span class="pas1-symbol">.</span><span class="pas1-identifier">ContentType</span><span class="pas1-symbol">:=</span><span class="pas1-space"> </span><span class="pas1-string">'application/json'</span><span class="pas1-symbol">;
</span><span class="pas1-space">    RequestHeader</span><span class="pas1-symbol">.</span><span class="pas1-identifier">Authorization</span><span class="pas1-symbol">:=</span><span class="pas1-space"> </span><span class="pas1-string">'Bearer '</span><span class="pas1-symbol">+</span><span class="pas1-space"> CHATGPT_APIKEY2</span><span class="pas1-symbol">;
</span><span class="pas1-space">    </span><span class="pas1-comment">//RequestHeader.RawHeaderText:='Authorization: Bearer '+ CHATGPT_APIKEY2;
</span><span class="pas1-space">    </span><span class="pas1-reservedword">try
</span><span class="pas1-space">      aPoststream</span><span class="pas1-symbol">:=</span><span class="pas1-space"> TStringStream</span><span class="pas1-symbol">.</span><span class="pas1-identifier">create</span><span class="pas1-symbol">(</span><span class="pas1-identifier">format</span><span class="pas1-symbol">(</span><span class="pas1-identifier">JPostData</span><span class="pas1-symbol">,[</span><span class="pas1-identifier">feedstream</span><span class="pas1-symbol">]));
</span><span class="pas1-space">      result</span><span class="pas1-symbol">:=</span><span class="pas1-space"> Post3</span><span class="pas1-symbol">(</span><span class="pas1-identifier">Url</span><span class="pas1-symbol">,</span><span class="pas1-space"> aPoststream</span><span class="pas1-symbol">);</span><span class="pas1-space"> </span><span class="pas1-comment">//overload;
</span><span class="pas1-space">    </span><span class="pas1-reservedword">finally
</span><span class="pas1-space">      Free</span><span class="pas1-symbol">;
</span><span class="pas1-space">      aPostStream</span><span class="pas1-symbol">.</span><span class="pas1-identifier">Free</span><span class="pas1-symbol">;
</span><span class="pas1-space">    </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;</span><span class="pas1-space"> 
  </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;</span><span class="pas1-space"> </span><span class="pas1-comment">//with   
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;</span><span class="pas1-space"> 

</span><span class="pas1-reservedword">var</span><span class="pas1-space"> atext</span><span class="pas1-symbol">:</span><span class="pas1-space"> </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;</span><span class="pas1-space">  jo</span><span class="pas1-symbol">:</span><span class="pas1-identifier">TJSON</span><span class="pas1-symbol">;

</span><span class="pas1-reservedword">Begin</span><span class="pas1-space"> </span><span class="pas1-comment">//@main
</span><span class="pas1-space">  </span><span class="pas1-comment">//atext:= 'bonjour mes amis da la ville';
</span><span class="pas1-space">  atext</span><span class="pas1-symbol">:=</span><span class="pas1-space"> URLEncode</span><span class="pas1-symbol">(</span><span class="pas1-string">'A research paper suggests improving GPT-4 performance by 30% by having it consider why it was wrong.'</span><span class="pas1-symbol">);
</span><span class="pas1-space"> </span><span class="pas1-comment">// atext:= 'bonjour mes amis';
</span><span class="pas1-space">  </span><span class="pas1-comment">//writeln((Text_to_traslate_API2(AURL, '','dict-chrome', 'es', atext)));
</span><span class="pas1-space">  </span><span class="pas1-comment">//writeln(utf8ToAnsi(Text_to_traslate_API2(AURL,'dict-chrome-ex','fr','es',atext)));
</span><span class="pas1-space">  writeln</span><span class="pas1-symbol">(</span><span class="pas1-identifier">utf8ToAnsi</span><span class="pas1-symbol">(</span><span class="pas1-identifier">Text_to_translate_API2</span><span class="pas1-symbol">(</span><span class="pas1-identifier">AURL</span><span class="pas1-symbol">,</span><span class="pas1-string">'dict-chrome-ex'</span><span class="pas1-symbol">,</span><span class="pas1-string">'auto'</span><span class="pas1-symbol">,</span><span class="pas1-string">'it'</span><span class="pas1-symbol">,</span><span class="pas1-identifier">atext</span><span class="pas1-symbol">)));
</span><span class="pas1-space">  sleep</span><span class="pas1-symbol">(500);
</span><span class="pas1-space">    
    </span><span class="pas1-comment">{jo:= TJSON.Create();
    try
    jo.parse(TESTRES_JSON) 
    writeln('answer: '+jo.values['choices'].asarray[0].asobject['text'].asstring);
    except
      writeln(ExceptiontoString(exceptiontype,exceptionparam));
    end;  
    jo.free;   //}
</span><span class="pas1-space">    
   </span><span class="pas1-comment">//writeln(AskChatGPT('how large is the earth?'));
</span><span class="pas1-space">   </span><span class="pas1-comment">// writeln(AskChatGPT('What is maXbox4?'));
</span><span class="pas1-space">   </span><span class="pas1-comment">//writeln(AskChatGPT('What is similar to maXbox4?'));
</span><span class="pas1-space">   
   writeln</span><span class="pas1-symbol">(</span><span class="pas1-string">'answer3 '</span><span class="pas1-symbol">+</span><span class="pas1-identifier">TALHTTPClient_AskChatGPT</span><span class="pas1-symbol">(</span><span class="pas1-string">'how large is the earth?'</span><span class="pas1-symbol">,</span><span class="pas1-string">''</span><span class="pas1-symbol">,</span><span class="pas1-reservedword">Nil</span><span class="pas1-symbol">,</span><span class="pas1-reservedword">Nil</span><span class="pas1-symbol">));
</span><span class="pas1-reservedword">End</span><span class="pas1-symbol">.

</span><span class="pas1-reservedword">doc</span><span class="pas1-symbol">:</span><span class="pas1-space"> Needs </span><span class="pas1-reservedword">to</span><span class="pas1-space"> be dict</span><span class="pas1-symbol">-</span><span class="pas1-identifier">chrome</span><span class="pas1-symbol">-</span><span class="pas1-identifier">ex </span><span class="pas1-reservedword">or</span><span class="pas1-space"> </span><span class="pas1-reservedword">else</span><span class="pas1-space"> you</span><span class="pas1-string">'ll get a 403 error.
</span><span class="pas1-space">     Exception</span><span class="pas1-symbol">:</span><span class="pas1-space"> WinHttp</span><span class="pas1-symbol">.</span><span class="pas1-identifier">WinHttpRequest</span><span class="pas1-symbol">:</span><span class="pas1-space"> The operation timed </span><span class="pas1-reservedword">out
</span><span class="pas1-space">     
     https</span><span class="pas1-symbol">:</span><span class="pas1-comment">//help.openai.com/en/articles/6882433-incorrect-api-key-provided

{&quot;id&quot;:&quot;cmpl-6zp3hsVt6HzUdDiCVKVkPcE0umXGm&quot;,&quot;object&quot;:&quot;text_completion&quot;,&quot;created&quot;:1680192297,&quot;model&quot;:&quot;text-davinci-003&quot;,&quot;choices&quot;:[{&quot;text&quot;:&quot;\n\nThe Earth has a mean radius of 3,959 miles (6,371 kilometers).&quot;,&quot;index&quot;:0,&quot;logprobs&quot;:null,&quot;finish_reason&quot;:&quot;stop&quot;}</span><span class="pas1-symbol">],&quot;</span><span class="pas1-identifier">usage</span><span class="pas1-symbol">&quot;:</span><span class="pas1-comment">{&quot;prompt_tokens&quot;:5,&quot;completion_tokens&quot;:20,&quot;total_tokens&quot;:25}</span><span class="pas1-symbol">}

</span><span class="pas1-comment">{&quot;id&quot;:&quot;cmpl-6zp8eDsADQT4Br6NKkFT3jJPYKJHU&quot;,&quot;object&quot;:&quot;text_completion&quot;,&quot;created&quot;:1680192604,&quot;model&quot;:&quot;text-davinci-003&quot;,&quot;choices&quot;:[{&quot;text&quot;:&quot;\n\nmaXbox4 is a free and open source scripting language and development environment for Windows. It is designed to be easy to use and provides a powerful scripting language for creating applications, games, and other software. maXbox4 is based on the popular BASIC language and includes a wide range of features, including support for object-oriented programming, graphical user interfaces, and more.&quot;,&quot;index&quot;:0,&quot;logprobs&quot;:null,&quot;finish_reason&quot;:&quot;stop&quot;}</span><span class="pas1-symbol">],&quot;</span><span class="pas1-identifier">usage</span><span class="pas1-symbol">&quot;:</span><span class="pas1-comment">{&quot;prompt_tokens&quot;:6,&quot;completion_tokens&quot;:77,&quot;total_tokens&quot;:83}</span><span class="pas1-symbol">}

</span><span class="pas1-identifier">Answer2</span><span class="pas1-symbol">:</span><span class="pas1-space"> 

maXbox4 </span><span class="pas1-reservedword">is</span><span class="pas1-space"> a free scripting tool </span><span class="pas1-reservedword">for</span><span class="pas1-space"> creating </span><span class="pas1-reservedword">and</span><span class="pas1-space"> running scripts written </span><span class="pas1-reservedword">in</span><span class="pas1-space"> the </span><span class="pas1-reservedword">PASCAL</span><span class="pas1-space"> language</span><span class="pas1-symbol">.</span><span class="pas1-space"> </span><span class="pas1-reservedword">It</span><span class="pas1-space"> </span><span class="pas1-reservedword">is</span><span class="pas1-space"> designed </span><span class="pas1-reservedword">to</span><span class="pas1-space"> be used </span><span class="pas1-reservedword">for</span><span class="pas1-space"> educational purposes </span><span class="pas1-reservedword">and</span><span class="pas1-space"> can be used </span><span class="pas1-reservedword">to</span><span class="pas1-space"> create programs </span><span class="pas1-reservedword">for</span><span class="pas1-space"> Windows</span><span class="pas1-symbol">,</span><span class="pas1-space"> Linux</span><span class="pas1-symbol">,</span><span class="pas1-space"> </span><span class="pas1-reservedword">and</span><span class="pas1-space"> Mac OS X</span><span class="pas1-symbol">.</span><span class="pas1-space"> maXbox4 includes a debugger</span><span class="pas1-symbol">,</span><span class="pas1-space"> an editor</span><span class="pas1-symbol">,</span><span class="pas1-space"> </span><span class="pas1-reservedword">and</span><span class="pas1-space"> a compiler</span><span class="pas1-symbol">,</span><span class="pas1-space"> </span><span class="pas1-reservedword">and</span><span class="pas1-space"> can be used </span><span class="pas1-reservedword">to</span><span class="pas1-space"> create programs </span><span class="pas1-reservedword">for</span><span class="pas1-space"> a variety </span><span class="pas1-reservedword">of</span><span class="pas1-space"> tasks</span><span class="pas1-symbol">,</span><span class="pas1-space"> including game development</span><span class="pas1-symbol">,</span><span class="pas1-space"> web development</span><span class="pas1-symbol">,</span><span class="pas1-space"> </span><span class="pas1-reservedword">and</span><span class="pas1-space"> automation</span><span class="pas1-symbol">.
</span><span class="pas1-space"> mX4 executed</span><span class="pas1-symbol">:</span><span class="pas1-space"> </span><span class="pas1-number">30/03/2023</span><span class="pas1-space"> </span><span class="pas1-number">21:17:56</span><span class="pas1-space">  Runtime</span><span class="pas1-symbol">:</span><span class="pas1-space"> </span><span class="pas1-number">0:0:</span><span class="pas1-float">3.489</span><span class="pas1-space">  Memload</span><span class="pas1-symbol">:</span><span class="pas1-space"> </span><span class="pas1-number">47%</span><span class="pas1-space"> use

answer2</span><span class="pas1-symbol">:</span><span class="pas1-space"> 

maXbox4 </span><span class="pas1-reservedword">is</span><span class="pas1-space"> a free scripting tool </span><span class="pas1-reservedword">and</span><span class="pas1-space"> open source </span><span class="pas1-reservedword">object</span><span class="pas1-space"> </span><span class="pas1-reservedword">pascal</span><span class="pas1-space"> ide </span><span class="pas1-reservedword">for</span><span class="pas1-space"> creating Windows</span><span class="pas1-symbol">,</span><span class="pas1-space"> Linux</span><span class="pas1-symbol">,</span><span class="pas1-space"> </span><span class="pas1-reservedword">and</span><span class="pas1-space"> macOS applications</span><span class="pas1-symbol">.</span><span class="pas1-space"> </span><span class="pas1-reservedword">It</span><span class="pas1-space"> </span><span class="pas1-reservedword">is</span><span class="pas1-space"> designed </span><span class="pas1-reservedword">to</span><span class="pas1-space"> be easy </span><span class="pas1-reservedword">to</span><span class="pas1-space"> use </span><span class="pas1-reservedword">and</span><span class="pas1-space"> provides a wide range </span><span class="pas1-reservedword">of</span><span class="pas1-space"> features</span><span class="pas1-symbol">,</span><span class="pas1-space"> including an integrated debugger</span><span class="pas1-symbol">,</span><span class="pas1-space"> code completion</span><span class="pas1-symbol">,</span><span class="pas1-space"> syntax highlighting</span><span class="pas1-symbol">,</span><span class="pas1-space"> </span><span class="pas1-reservedword">and</span><span class="pas1-space"> more</span><span class="pas1-symbol">.</span><span class="pas1-space"> maXbox4 </span><span class="pas1-reservedword">is</span><span class="pas1-space"> based </span><span class="pas1-reservedword">on</span><span class="pas1-space"> the Free </span><span class="pas1-reservedword">Pascal</span><span class="pas1-space"> compiler </span><span class="pas1-reservedword">and</span><span class="pas1-space"> Lazarus IDE</span><span class="pas1-symbol">.
</span><span class="pas1-space"> mX4 executed</span><span class="pas1-symbol">:</span><span class="pas1-space"> </span><span class="pas1-number">30/03/2023</span><span class="pas1-space"> </span><span class="pas1-number">21:22:19</span><span class="pas1-space">  Runtime</span><span class="pas1-symbol">:</span><span class="pas1-space"> </span><span class="pas1-number">0:0:</span><span class="pas1-float">4.92</span><span class="pas1-space">  Memload</span><span class="pas1-symbol">:</span><span class="pas1-space"> </span><span class="pas1-number">47%</span><span class="pas1-space"> use
 
Answer2</span><span class="pas1-symbol">:</span><span class="pas1-space"> 

maXbox4 </span><span class="pas1-reservedword">is</span><span class="pas1-space"> a free </span><span class="pas1-reservedword">and</span><span class="pas1-space"> open source software development tool </span><span class="pas1-reservedword">for</span><span class="pas1-space"> creating </span><span class="pas1-reservedword">and</span><span class="pas1-space"> running programs written </span><span class="pas1-reservedword">in</span><span class="pas1-space"> the </span><span class="pas1-reservedword">Object</span><span class="pas1-space"> </span><span class="pas1-reservedword">Pascal</span><span class="pas1-space"> programming language</span><span class="pas1-symbol">.</span><span class="pas1-space"> </span><span class="pas1-reservedword">It</span><span class="pas1-space"> </span><span class="pas1-reservedword">is</span><span class="pas1-space"> designed </span><span class="pas1-reservedword">to</span><span class="pas1-space"> be used </span><span class="pas1-reservedword">with</span><span class="pas1-space"> the Lazarus IDE</span><span class="pas1-symbol">,</span><span class="pas1-space"> </span><span class="pas1-reservedword">and</span><span class="pas1-space"> </span><span class="pas1-reservedword">is</span><span class="pas1-space"> based </span><span class="pas1-reservedword">on</span><span class="pas1-space"> the Delphi compiler</span><span class="pas1-symbol">.</span><span class="pas1-space"> maXbox4 </span><span class="pas1-reservedword">is</span><span class="pas1-space"> a powerful tool </span><span class="pas1-reservedword">for</span><span class="pas1-space"> creating applications </span><span class="pas1-reservedword">for</span><span class="pas1-space"> Windows</span><span class="pas1-symbol">,</span><span class="pas1-space"> Linux</span><span class="pas1-symbol">,</span><span class="pas1-space"> Mac OS X</span><span class="pas1-symbol">,</span><span class="pas1-space"> iOS</span><span class="pas1-symbol">,</span><span class="pas1-space"> </span><span class="pas1-reservedword">and</span><span class="pas1-space"> </span><span class="pas1-reservedword">Android</span><span class="pas1-symbol">.</span><span class="pas1-space"> </span><span class="pas1-reservedword">It</span><span class="pas1-space"> includes a wide range </span><span class="pas1-reservedword">of</span><span class="pas1-space"> features</span><span class="pas1-symbol">,</span><span class="pas1-space"> such </span><span class="pas1-reservedword">as</span><span class="pas1-space"> a visual designer</span><span class="pas1-symbol">,</span><span class="pas1-space"> debugging tools</span><span class="pas1-symbol">,</span><span class="pas1-space"> </span><span class="pas1-reservedword">and</span><span class="pas1-space"> a code editor</span><span class="pas1-symbol">.
</span><span class="pas1-space"> mX4 executed</span><span class="pas1-symbol">:</span><span class="pas1-space"> </span><span class="pas1-number">30/03/2023</span><span class="pas1-space"> </span><span class="pas1-number">22:27:07</span><span class="pas1-space">  Runtime</span><span class="pas1-symbol">:</span><span class="pas1-space"> </span><span class="pas1-number">0:0:</span><span class="pas1-float">3.824</span><span class="pas1-space">  Memload</span><span class="pas1-symbol">:</span><span class="pas1-space"> </span><span class="pas1-number">49%</span><span class="pas1-space"> use

</span><span class="pas1-reservedword">ref</span><span class="pas1-symbol">:</span><span class="pas1-space"> https</span><span class="pas1-symbol">:</span><span class="pas1-comment">//github.com/rilyu/json4delphi/issues/7

</span><span class="pas1-space"> mX4 executed</span><span class="pas1-symbol">:</span><span class="pas1-space"> </span><span class="pas1-number">27/03/2023</span><span class="pas1-space"> </span><span class="pas1-number">17:52:23</span><span class="pas1-space">  Runtime</span><span class="pas1-symbol">:</span><span class="pas1-space"> </span><span class="pas1-number">0:4:</span><span class="pas1-float">58.888</span><span class="pas1-space">  Memload</span><span class="pas1-symbol">:</span><span class="pas1-space"> </span><span class="pas1-number">39%</span><span class="pas1-space"> use

</span><span class="pas1-reservedword">Doc</span><span class="pas1-symbol">:</span><span class="pas1-space"> The task
    Simulate several thousand instances </span><span class="pas1-reservedword">of</span><span class="pas1-space"> the game where the prisoners randomly open drawers
    Simulate several thousand instances </span><span class="pas1-reservedword">of</span><span class="pas1-space"> the game where the prisoners use the optimal strategy mentioned </span><span class="pas1-reservedword">in</span><span class="pas1-space"> the Wikipedia article</span><span class="pas1-symbol">,</span><span class="pas1-space"> </span><span class="pas1-reservedword">of</span><span class="pas1-symbol">:

</span><span class="pas1-space">    First opening the drawer whose outside number </span><span class="pas1-reservedword">is</span><span class="pas1-space"> his prisoner number</span><span class="pas1-symbol">.
</span><span class="pas1-space">    </span><span class="pas1-reservedword">If</span><span class="pas1-space"> the card within has his number </span><span class="pas1-reservedword">then</span><span class="pas1-space"> he succeeds otherwise he opens the drawer </span><span class="pas1-reservedword">with</span><span class="pas1-space"> the same number </span><span class="pas1-reservedword">as</span><span class="pas1-space"> that </span><span class="pas1-reservedword">of</span><span class="pas1-space"> the revealed card</span><span class="pas1-symbol">.</span><span class="pas1-space"> </span><span class="pas1-symbol">(</span><span class="pas1-reservedword">until</span><span class="pas1-space"> he opens his maximum</span><span class="pas1-symbol">).
</span><span class="pas1-space">     


</span></code></pre><!--EndFragment--></body>
</html>